<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Signature</title>
  <style>
    body { font-family: sans-serif; text-align: center; background: #f2f2f2; margin: 0; }
    canvas { border: 2px solid #444; background: #fff; touch-action: none; }
    .btns { margin-top: 10px; }
    button { padding: 10px 20px; margin: 5px; font-size: 16px; }
  </style>
</head>
<body>
  <h2>Veuillez signer ci-dessous üñãÔ∏è</h2>
  <canvas id="signatureCanvas" width="300" height="150"></canvas>
  <div class="btns">
    <button onclick="clearCanvas()">Effacer</button>
    <button onclick="saveSignature()">Valider</button>
  </div>

  <script>
    const canvas = document.getElementById("signatureCanvas");
    const ctx = canvas.getContext("2d");
    let drawing = false;

    const getPos = e => {
      if (e.touches) return { x: e.touches[0].clientX - canvas.offsetLeft, y: e.touches[0].clientY - canvas.offsetTop };
      return { x: e.clientX - canvas.offsetLeft, y: e.clientY - canvas.offsetTop };
    };

    const startDraw = e => { drawing = true; const p = getPos(e); ctx.beginPath(); ctx.moveTo(p.x, p.y); };
    const draw = e => {
      if (!drawing) return;
      e.preventDefault();
      const p = getPos(e);
      ctx.lineTo(p.x, p.y);
      ctx.strokeStyle = "#000";
      ctx.lineWidth = 2;
      ctx.stroke();
    };
    const endDraw = () => { drawing = false; ctx.closePath(); };

    canvas.addEventListener("mousedown", startDraw);
    canvas.addEventListener("mousemove", draw);
    canvas.addEventListener("mouseup", endDraw);
    canvas.addEventListener("mouseout", endDraw);

    canvas.addEventListener("touchstart", startDraw, { passive: false });
    canvas.addEventListener("touchmove", draw, { passive: false });
    canvas.addEventListener("touchend", endDraw);

    function clearCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    function saveSignature() {
      const image = canvas.toDataURL("image/png");
      const link = document.createElement("a");
      link.href = image;
      link.download = "signature.png";
      link.click();
    }
  </script>
</body>
</html>